<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: transparent; background-color: transparent; color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="637px" height="564px" viewBox="-0.5 -0.5 637 564"><defs><clipPath id="mx-clip-4-31-232-304-0"><rect x="4" y="31" width="232" height="304"/></clipPath><clipPath id="mx-clip-276-141-317-114-0"><rect x="276" y="141" width="317" height="114"/></clipPath><clipPath id="mx-clip-276-511-192-54-0"><rect x="276" y="511" width="192" height="54"/></clipPath><clipPath id="mx-clip-276-411-192-54-0"><rect x="276" y="411" width="192" height="54"/></clipPath><clipPath id="mx-clip-510-473-122-44-0"><rect x="510" y="473" width="122" height="44"/></clipPath><clipPath id="mx-clip-276-321-162-44-0"><rect x="276" y="321" width="162" height="44"/></clipPath><clipPath id="mx-clip-510-361-122-44-0"><rect x="510" y="361" width="122" height="44"/></clipPath></defs><g><g data-cell-id="YkwdzpHEv2ZosyQvh-av-0"><g data-cell-id="YkwdzpHEv2ZosyQvh-av-1"><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-0"><g><path d="M 0 26 L 0 0 L 240 0 L 240 26" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 26 L 0 330 L 240 330 L 240 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 26 L 240 26" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="14px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="120" y="20">Session</text></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-1"><g><rect x="0" y="26" width="240" height="304" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-4-31-232-304-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="6" y="44">string version = 1;</text><text x="6" y="58">uint32 e2ees_pack_id = 2;</text><text x="6" y="72">string session_id = 3;</text><text x="6" y="86">E2eeAddress our_address = 4;</text><text x="6" y="100">E2eeAddress their_address = 5;</text><text x="6" y="128">Ratchet ratchet = 11;</text><text x="6" y="142">bytes associated_data = 12;</text><text x="6" y="156">bytes temp_shared_secret = 13;</text><text x="6" y="170">bytes fingerprint = 14;</text><text x="6" y="198">KeyPair alice_base_key = 21;</text><text x="6" y="212">uint32 bob_signed_pre_key_id = 22;</text><text x="6" y="226">uint32 bob_one_time_pre_key_id = 23;</text><text x="6" y="240">repeated bytes pre_shared_input_list = 24;</text><text x="6" y="268">bool f2f = 31;</text><text x="6" y="282">bool responded = 32;</text><text x="6" y="296">int64 invite_t = 33;</text><text x="6" y="310">bool short_term = 34;</text></g></g></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-2"><g><path d="M 271.5 136 L 271.5 110 L 596.5 110 L 596.5 136" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 271.5 136 L 271.5 250 L 596.5 250 L 596.5 136" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 271.5 136 L 596.5 136" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="14px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="434" y="130">Ratchet</text></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-3"><g><rect x="271.5" y="136" width="325" height="114" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-276-141-317-114-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="277.5" y="154">bytes root_key = 1;</text><text x="277.5" y="168">uint32 root_sequence = 2;</text><text x="277.5" y="182">uint32 sending_message_sequence = 3;</text><text x="277.5" y="196">uint32 received_message_sequence = 4;</text><text x="277.5" y="210">SenderChainNode sender_chain = 5;</text><text x="277.5" y="224">ReceiverChainNode receiver_chain = 6;</text><text x="277.5" y="238">repeated SkippedMsgKeyNode skipped_msg_key_list = 7;</text></g></g></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-4"><g><path d="M 271.5 506 L 271.5 480 L 471.5 480 L 471.5 506" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 271.5 506 L 271.5 560 L 471.5 560 L 471.5 506" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 271.5 506 L 471.5 506" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="14px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="371.5" y="500">SenderChainNode</text></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-5"><g><rect x="271.5" y="506" width="200" height="54" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-276-511-192-54-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="277.5" y="524">bytes our_ratchet_public_key = 1;</text><text x="277.5" y="538">bytes their_ratchet_public_key = 2;</text><text x="277.5" y="552">ChainKey chain_key = 3;</text></g></g></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-6"><g><path d="M 271.5 406 L 271.5 380 L 471.5 380 L 471.5 406" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 271.5 406 L 271.5 460 L 471.5 460 L 471.5 406" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 271.5 406 L 471.5 406" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="14px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="371.5" y="400">ReceiverChainNode</text></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-7"><g><rect x="271.5" y="406" width="200" height="54" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-276-411-192-54-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="277.5" y="424">bytes their_ratchet_public_key = 1;</text><text x="277.5" y="438">bytes our_ratchet_private_key = 2;</text><text x="277.5" y="452">ChainKey chain_key = 3;</text></g></g></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-8"><g><path d="M 506 468 L 506 442 L 636 442 L 636 468" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 506 468 L 506 512 L 636 512 L 636 468" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 506 468 L 636 468" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="14px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="571" y="462">ChainKey</text></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-9"><g><rect x="506" y="468" width="130" height="44" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-510-473-122-44-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="512" y="486">uint32 index = 1;</text><text x="512" y="500">bytes shared_key = 2;</text></g></g></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-10"><g><path d="M 271.5 316 L 271.5 290 L 441.5 290 L 441.5 316" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 271.5 316 L 271.5 360 L 441.5 360 L 441.5 316" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 271.5 316 L 441.5 316" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="14px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="356.5" y="310">SkippedMsgKeyNode</text></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-11"><g><rect x="271.5" y="316" width="170" height="44" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-276-321-162-44-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="277.5" y="334">bytes ratchet_key_public = 1;</text><text x="277.5" y="348">MsgKey msg_key = 2;</text></g></g></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-12"><g><path d="M 506 356 L 506 330 L 636 330 L 636 356" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 506 356 L 506 400 L 636 400 L 636 356" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 506 356 L 636 356" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="14px" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="571" y="350">MsgKey</text></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-13"><g><rect x="506" y="356" width="130" height="44" fill="#ffffff" stroke="none" pointer-events="all" style="fill: rgb(255, 255, 255);"/></g><g><g fill="#000000" font-family="Helvetica" font-size="12px" clip-path="url(#mx-clip-510-361-122-44-0)" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><text x="512" y="374">uint32 index = 1;</text><text x="512" y="388">bytes derived_key = 2;</text></g></g></g></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-16"><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-17"/></g><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-18"><g data-cell-id="tgxJ8lzeyc_RPj6M9vG0-19"/></g><g data-cell-id="-s4r_1TsaPjzUiJBxQrH-0"><g data-cell-id="-s4r_1TsaPjzUiJBxQrH-1"/></g><g data-cell-id="-s4r_1TsaPjzUiJBxQrH-2"/><g data-cell-id="elUg12UE3iu_LM4cGDYE-0"><g data-cell-id="elUg12UE3iu_LM4cGDYE-1"/></g><g data-cell-id="BEYrHYv9CIQZ93qOi1ey-3"><g><path d="M 126 124 L 263.51 124" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 268.76 124 L 261.76 127.5 L 263.51 124 L 261.76 120.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="ycRJZo0U8VZCd2VdMa3f-0"/><g data-cell-id="ycRJZo0U8VZCd2VdMa3f-1"/><g data-cell-id="aQM8-L3IFbETCL3_f2g8-1"><g><path d="M 265.13 307.5 L 261 307.5 L 261 235 L 276 235" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 270.38 307.5 L 263.38 311 L 265.13 307.5 L 263.38 304 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="aQM8-L3IFbETCL3_f2g8-2"><g><path d="M 264.53 389.6 L 256 389.6 L 256 220 L 276 220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 269.78 389.6 L 262.78 393.1 L 264.53 389.6 L 262.78 386.1 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="aQM8-L3IFbETCL3_f2g8-3"><g><path d="M 264.63 490 L 251 490 L 251 205 L 276 205" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 269.88 490 L 262.88 493.5 L 264.63 490 L 262.88 486.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="aQM8-L3IFbETCL3_f2g8-5"><g><path d="M 411 345 L 499.63 345" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 504.88 345 L 497.88 348.5 L 499.63 345 L 497.88 341.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="aQM8-L3IFbETCL3_f2g8-6"><g><path d="M 436 450 L 499.63 450" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 504.88 450 L 497.88 453.5 L 499.63 450 L 497.88 446.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="aQM8-L3IFbETCL3_f2g8-7"><g><path d="M 436 550 L 486 550 L 486 459.5 L 499.63 459.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 504.88 459.5 L 497.88 463 L 499.63 459.5 L 497.88 456 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g></g></g></g></svg>